import { Knex } from 'knex';
import { FailedValidationException } from '../exceptions';
import { AbstractServiceOptions, Accountability, AST, Filter, Item, PermissionsAction, PrimaryKey, SchemaOverview } from '../types';
import { PayloadService } from './payload';
export declare class AuthorizationService {
    knex: Knex;
    accountability: Accountability | null;
    payloadService: PayloadService;
    schema: SchemaOverview;
    constructor(options: AbstractServiceOptions);
    processAST(ast: AST, action?: PermissionsAction): Promise<AST>;
    /**
     * Checks if the provided payload matches the configured permissions, and adds the presets to the payload.
     */
    validatePayload(action: PermissionsAction, collection: string, data: Partial<Item>): Promise<Partial<Item>>;
    validateJoi(validation: Filter, payload: Partial<Item>): FailedValidationException[];
    checkAccess(action: PermissionsAction, collection: string, pk: PrimaryKey | PrimaryKey[]): Promise<void>;
}
